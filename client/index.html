<html>
  <head>
    <meta charset="utf-8" />
    <title>Display a map on a webpage</title>
    <meta
      name="viewport"
      content="initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <link
      href="https://api.mapbox.com/mapbox-gl-js/v2.7.0/mapbox-gl.css"
      rel="stylesheet"
    />
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.7.0/mapbox-gl.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/Turf.js/6.5.0/turf.min.js"
      integrity="sha512-Q7HOppxoH0L2M7hreVoFCtUZimR2YaY0fBewIYzkCgmNtgOOZ5IgMNYxHgfps0qrO1ef5m7L1FeHrhXlq1I9HA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      #map {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
      // const aoi = {
      //   type: "Polygon",
      //   coordinates: [
      //     [
      //       [-98.50508619798347, 29.42772236885503],
      //       [-98.49743951344863, 29.4292896380648],
      //       [-98.4975281311199, 29.421804640442133],
      //       [-98.50508619798347, 29.42772236885503],
      //     ],
      //   ],
      // };
      const aoi = {
        type: "Polygon",
        coordinates: [
          [
            [-97.9230247019844, 29.564137700727],
            [-97.938626340119, 29.3940107295051],
            [-97.6020767174967, 29.3862414798855],
            [-97.5931614957055, 29.5874028237309],
            [-97.8316436786231, 29.6145386945022],
            [-97.9230247019844, 29.564137700727],
          ],
        ],
      };
      const bbox = turf.bbox(aoi);
      mapboxgl.accessToken =
        "pk.eyJ1IjoidW1hcm11bmVlcjIwMTAiLCJhIjoiY2tta2dkcnI3MTB3YzJ1czcwd2dyejVqaSJ9.ba-W1B5R71tQ2vBK6ee8tA";
      const map = new mapboxgl.Map({
        container: "map", // container ID
        style: "mapbox://styles/mapbox/streets-v11", // style URL
        center: [-97.833637, 29.59581], // starting position [lng, lat]
        zoom: 14, // starting zoom
      });
      map.on("load", () => {
        map.fitBounds(bbox);
        map.addSource("aoi", {
          type: "geojson",
          data: aoi,
        });
        map.addLayer({
          id: "aoi-layer",
          source: "aoi",
          type: "line",
          layout: {},
          paint: {
            "line-color": "#c01b1b",
            "line-width": 3,
          },
        });
        map.addSource("test-vector", {
          type: "vector",
          tiles: ["http://34.71.113.166:3005/vt/{z}/{x}/{y}"],
          minzoom: 2,
          maxzoom: 14,
        });
        map.addLayer({
          id: "test-vector-layer-landcover",
          type: "fill",
          source: "test-vector",
          "source-layer": "geojsonLayer",
          paint: {
            "fill-color": "green",
            "fill-opacity": 0.7,
          },
          filter: ["==", ["get", "transect_feature_type"], "landcover"],
        });
        map.addLayer({
          id: "test-vector-layer-hydro",
          type: "fill",
          source: "test-vector",
          "source-layer": "geojsonLayer",
          paint: {
            "fill-color": "red",
            "fill-opacity": 0.7,
          },
          filter: ["==", ["get", "transect_feature_type"], "hydrography"],
        });
        map.addLayer({
          id: "test-vector-layer-soil",
          type: "fill",
          source: "test-vector",
          "source-layer": "geojsonLayer",
          paint: {
            "fill-color": "pink",
            "fill-opacity": 0.4,
          },
          filter: ["==", ["get", "transect_feature_type"], "soil"],
        });
      });
    </script>
  </body>
</html>
